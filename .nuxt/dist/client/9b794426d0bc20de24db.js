(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{330:function(t,e,o){var content=o(375);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(9).default)("1da821fa",content,!0,{sourceMap:!1})},373:function(t,e,o){var content=o(516);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(9).default)("bcf4a2a2",content,!0,{sourceMap:!1})},374:function(t,e,o){"use strict";var r=o(330);o.n(r).a},375:function(t,e,o){(e=o(8)(!1)).push([t.i,".nowrap{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.publish-header-title{text-align:center;position:relative;font-size:16px;height:48px;line-height:48px;color:#dcddde;border-bottom:1px solid #2f3136}.publish-header-title .publish-header-title-back{position:absolute;cursor:pointer;height:24px;line-height:24px;top:12px;left:12px;text-align:right;padding-right:8px;padding-left:15px;font-size:10px;color:#dcddde;background:#484b53}.publish-header-title .publish-header-title-back .publish-header-title-back-icon1{position:absolute;width:0;height:0;border:12px solid transparent;border-right-color:#484b53;top:0;left:-24px}.publish-header-title .publish-header-title-back .publish-header-title-back-icon2{position:absolute;width:0;height:0;border:4px solid transparent;border-right-color:#7a7d84;top:8px;left:-2px}",""]),t.exports=e},376:function(t,e,o){var content=o(518);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(9).default)("19c9fda2",content,!0,{sourceMap:!1})},411:function(t,e,o){"use strict";var r={name:"CommunityPublicHeader",props:{btnText:{type:String,default:"返回首页"},titleText:{type:String,default:"编辑文章"},to:{type:String,default:""}},data:function(){return{}},methods:{}},l=(o(374),o(2)),component=Object(l.a)(r,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"publish-header"},[e("div",{staticClass:"publish-header-title"},[this._v(this._s(this.titleText)),e("n-link",{attrs:{to:this.to}},[e("div",{staticClass:"publish-header-title-back"},[this._v(this._s(this.btnText)),e("div",{staticClass:"publish-header-title-back-icon1"}),e("div",{staticClass:"publish-header-title-back-icon2"})])])],1)])}),[],!1,null,null,null);e.a=component.exports},515:function(t,e,o){"use strict";var r=o(373);o.n(r).a},516:function(t,e,o){(e=o(8)(!1)).push([t.i,'.nowrap{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.editor .ql-toolbar{border:none}.editor .ql-toolbar span{color:#72767d}.editor .ql-container{background:#303339;border-radius:3px;border:1px solid #222428!important;font-size:14px;color:#72767d;height:315px;word-wrap:break-word;word-break:break-all}.editor .ql-editor.ql-blank:before{color:#72767d;content:"请输入";font-style:normal}.editor .ql-snow .ql-stroke{stroke:#72767d}.editor .ql-snow .ql-fill,.editor .ql-snow .ql-stroke.ql-fill{fill:#72767d}.editor .ql-toolbar.ql-snow .ql-picker.ql-expanded .ql-picker-options{background:#36393f;color:#72767d;border:1px solid #222428}',""]),t.exports=e},517:function(t,e,o){"use strict";var r=o(376);o.n(r).a},518:function(t,e,o){(e=o(8)(!1)).push([t.i,".nowrap{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.publish{display:flex}.publish .publish-left{flex-grow:1;flex-shrink:222;background:#36393f;padding:0 20px 20px;height:calc(100vh - 248px);overflow-y:auto}.publish .publish-left .el-textarea__inner{background:#303339}.publish .publish-left .publish-tit{padding:20px 0 15px;color:#dcddde;font-size:14px}.publish .publish-left .publish-uploader{display:flex}.publish .publish-left .publish-uploader .publish-uploader-box{width:200px;height:112px;line-height:112px;background:#303339;border:1px solid #222428;border-radius:3px;text-align:center}.publish .publish-left .publish-uploader .publish-uploader-box i{font-size:34px;color:#72767d;padding:36px 80px}.publish .publish-left .publish-uploader .publish-uploader-box .publish-upload-img{width:200px;height:112px}.publish .publish-left .publish-uploader .publish-upload-font{font-size:14px;color:#72767d;line-height:20px;padding-left:10px;display:flex;flex-direction:column;justify-content:flex-end}.publish .publish-left .publish-uploader .publish-upload-font p{margin:0}.publish .publish-left .publish-footer{padding-top:10px;margin-top:20px;border-top:1px solid #2f3136;text-align:center}.publish .publish-right{width:254px}.publish .publish-right .publish-draft-title{font-size:16px;text-align:center;color:#dcddde;height:48px;line-height:48px;border-bottom:1px solid #2a2c31}.publish .publish-right .publish-draft-add{width:220px;height:46px;line-height:46px;text-align:center;border:2px dashed #53565d;opacity:1;border-radius:4px;margin:20px auto;color:#dcddde;font-size:14px;cursor:pointer}.publish .publish-right .publish-draft-list{padding:0 20px;overflow-y:auto;height:calc(100vh - 382px)}.publish .publish-right .publish-draft-list .publish-draft-item{height:40px;line-height:40px;color:#72767d;border-radius:4px;padding:0 10px;overflow:hidden}.publish .publish-right .publish-draft-list .publish-draft-item i{float:right;display:none;cursor:pointer}.publish .publish-right .publish-draft-list .publish-draft-item span{cursor:pointer;display:inline-block}.publish .publish-right .publish-draft-list .publish-draft-item:hover{background:#393c43}.publish .publish-right .publish-draft-list .publish-draft-item:hover i{display:inline-block}",""]),t.exports=e},587:function(t,e,o){"use strict";o.r(e);o(22),o(12),o(11),o(5),o(14);var r,l=o(4),n=o(513),d=o.n(n),input=(o(24),o(91)),c=o.n(input),h=o(20),f={props:{value:{type:String,default:""}},data:function(){var t=this;return{editorOption:{modules:{toolbar:{container:[["bold","italic","underline","strike"],["link","image","video"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{color:[]},{background:[]}],[{align:[]}],["clean"]],handlers:{image:function(){this.quill.format("image",!1),t.uploadHandler(this,"img")},video:function(){this.quill.format("video",!1),t.uploadHandler(this,"video")}}}}},content:"",isLoading:"",progress:"",uploadType:""}},watch:{value:function(){this.content=this.value}},mounted:function(){this.event_id=this.$route.query.event_id},methods:{handleRemove:function(t,e){},handlePreview:function(t){},onEditorBlur:function(t){},onEditorFocus:function(t){},onEditorReady:function(t){},onEditorChange:function(t){t.editor;var html=t.html;t.text;this.content=html,this.$emit("updata",html)},uploadHandler:function(t,e){this.quill=t.quill,this.uploadType=e;var o=document.getElementById("file");o.value="",o.click()},doUpload:function(){var t=this,e=document.getElementById("file").files[0],o=new FormData;o.append("multiFile",e);var r={headers:{"Content-Type":"multipart/form-data"},onUploadProgress:function(e){var o=(e.loaded/e.total*100|0)+"%";t.progress=o}};this.isLoading=!0,this.$axios.post("pgc/fastdfs/upload",o,r).then((function(e){if("100"===e.code){t.isLoading=!1;var o=e.data.url,r=t.quill.getSelection(),l=0+(null!==r?r.index:0);"img"===t.uploadType?t.quill.insertEmbed(l,"image",o):t.quill.insertEmbed(l,"simpleVideo",{url:o,controls:"controls",width:"",height:""}),t.quill.setSelection(1+l)}})).catch((function(){t.isLoading=!1}))}}},m=(o(515),o(2)),v=Object(m.a)(f,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"editor"},[o("section",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoading,expression:"isLoading"}],staticClass:"editor-container",attrs:{"element-loading-text":"上传进度"+t.progress,"element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"}},[o("input",{ref:"input",staticClass:"file",staticStyle:{display:"none"},attrs:{id:"file",type:"file"},on:{change:t.doUpload}}),t._v(" "),o("div",{directives:[{name:"quill",rawName:"v-quill:myQuillEditor",value:t.editorOption,expression:"editorOption",arg:"myQuillEditor"}],staticClass:"quill-editor",attrs:{content:t.content},on:{change:function(e){return t.onEditorChange(e)},blur:function(e){return t.onEditorBlur(e)},focus:function(e){return t.onEditorFocus(e)},ready:function(e){return t.onEditorReady(e)}}})])])}),[],!1,null,null,null).exports,x=o(411),y=o(420),w=o(421),C=o(410),k=30,_=30;function O(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(object);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,o)}return e}function j(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?O(Object(source),!0).forEach((function(e){Object(l.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):O(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var E={name:"Publish",components:(r={},Object(l.a)(r,c.a.name,c.a),Object(l.a)(r,d.a.name,d.a),Object(l.a)(r,"Editor",v),Object(l.a)(r,"CommunityPublicHeader",x.a),Object(l.a)(r,"CommunityDialog",y.a),Object(l.a)(r,"NnEditer",C.a),Object(l.a)(r,"NewsItemTranspondList",w.a),r),data:function(){return{title:"",thumb:"",frontCover:"",content:"1111",forwardComment:"",transpond:[],forwardsFlag:!1,time:null,darftMaxLength:_}},computed:j(j(j({},Object(h.e)("community",["darftList","darftId"])),Object(h.c)("community",["darftCurrent"])),Object(h.e)(["user"])),watch:{darftCurrent:function(){this.thumb=this.darftCurrent.thumb,this.frontCover=this.darftCurrent.frontCover,this.title=this.darftCurrent.title}},created:function(){this.init(),this.autoSave()},beforeDestroy:function(){this.$store.commit("community/setState",["darftId",null]),clearInterval(this.time)},methods:{handleSuccess:function(t,e){"100"===t.retCode&&(this.thumb=t.retData.thumbUrl,this.frontCover=t.retData.url)},autoSave:function(){var t=this;this.time=setInterval((function(){t.saveDarft("auto")}),1e3*k)},beforeUpload:function(t){var e="image/jpeg"===t.type||"image/png"===t.type,o=t.size/1024/1024<2;return e||this.$message.error("上传头像图片只能是 JPG 格式!"),o||this.$message.error("上传头像图片大小不能超过 2MB!"),e&&o},onNext:function(){var t=this;this.saveDarft().then((function(){t.forwardsFlag=!0}))},onTranspondUpdata:function(data){this.transpond=data},buildArticleParams:function(){return{communityId:1,publishUid:this.user.userId,forwardComment:this.forwardComment||null,content:this.content,id:this.darftId,frontCover:this.frontCover,thumb:this.thumb,title:this.title}},editorUpdata:function(html){this.content=html},init:function(){this.$store.dispatch("community/getDarftList",1)},onAddArticle:function(){this.$store.commit("community/setState",["darftId",null])},saveDarft:function(t){var e=this;this.darftList.length>=this.darftMaxLength&&this.$message.error("您的草稿超过了".concat(this.darftMaxLength,"条，无法保存！"));var o=this.buildArticleParams();o.publishUid&&o.title&&o.content&&o.thumb?this.$store.dispatch("community/saveDarft",o).then((function(){e.init()})):t||this.$message.error("标题、正文、封面不能为空！")},saveArticle:function(data){this.forwardComment=data,this.forwardsFlag=!1;var t=this.buildArticleParams();this.$store.dispatch("community/articlePublish",t)},onSelectDarft:function(t){this.$store.commit("community/setState",["darftId",t.id])}}},P=(o(517),Object(m.a)(E,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"publish"},[o("div",{staticClass:"publish-left"},[o("CommunityPublicHeader",{attrs:{to:"/channels/FIFA18"}}),o("div",{staticClass:"publish-body"},[o("div",{staticClass:"publish-tit"},[t._v("标题文本")]),o("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请输入标题"},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}}),o("div",{staticClass:"publish-tit"},[t._v("编辑正文")]),o("Editor",{attrs:{value:t.darftCurrent.content},on:{updata:t.editorUpdata}}),o("div",{staticClass:"publish-tit"},[t._v("封面设置")]),o("div",{staticClass:"publish-uploader"},[o("el-upload",{staticClass:"publish-uploader-box",attrs:{action:"/pgcapi/pgc/fastdfs/upload",name:"multiFile","show-file-list":!1,"on-success":t.handleSuccess,"before-upload":t.beforeUpload}},[t.thumb?o("img",{staticClass:"publish-upload-img",attrs:{src:t.thumb}}):t._e(),t.thumb?t._e():o("i",{staticClass:"iconfont iconUploadpicture"})]),t._m(0)],1)],1),o("div",{staticClass:"publish-footer"},[o("el-button",{attrs:{round:""}},[t._v("预览")]),o("el-button",{attrs:{round:""},on:{click:t.saveDarft}},[t._v("保存")]),o("el-button",{attrs:{type:"primary",round:""},on:{click:t.onNext}},[t._v("下一步")])],1)],1),o("div",{staticClass:"publish-right"},[o("div",{staticClass:"publish-draft-title"},[t._v("草稿箱 ("+t._s(t.darftList.length||0)+"/"+t._s(t.darftMaxLength)+")")]),o("div",{staticClass:"publish-draft-add",on:{click:t.onAddArticle}},[t._v("+ 添加新文章")]),o("div",{staticClass:"publish-draft-list"},t._l(t.darftList,(function(e){return o("div",{key:e.id,staticClass:"publish-draft-item"},[o("i",{staticClass:"iconfont iconshanchu"}),o("span",{on:{click:function(o){return t.onSelectDarft(e)}}},[t._v(t._s(e.title))])])})),0)]),o("CommunityDialog",{attrs:{title:"转发动态",visible:t.forwardsFlag,width:"30%","close-on-click-modal":!1,"destroy-on-close":!0},on:{"update:visible":function(e){t.forwardsFlag=e}}},[o("NnEditer",{attrs:{buttonText:"发布",placeholder:"把文章分享给粉丝们吧！",inputClass:"content2"},on:{submit:t.saveArticle}},[o("NewsItemTranspondList",{on:{updata:t.onTranspondUpdata}})],1)],1)],1)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"publish-upload-font"},[e("p",[this._v("图片比列:16:9 ")]),e("p",[this._v("仅支持png、jpg图片，不大于20Mb")])])}],!1,null,null,null));e.default=P.exports}}]);